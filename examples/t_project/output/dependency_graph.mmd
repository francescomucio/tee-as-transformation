graph LR
    classDef testNode fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    classDef functionNode fill:#fff3e0,stroke:#e65100,stroke-width:2px

    my_schema_calculate_percentage["my_schema.calculate_percentage (function)"]:::functionNode
    my_schema_complex_join["my_schema.complex_join"]
    my_schema_incremental_example["my_schema.incremental_example"]
    my_schema_my_auto_table_one["my_schema.my_auto_table_one"]
    my_schema_my_first_table["my_schema.my_first_table"]
    my_schema_my_first_table_from_loop["my_schema.my_first_table_from_loop"]
    my_schema_my_forth_table["my_schema.my_forth_table"]
    my_schema_my_second_table["my_schema.my_second_table"]
    my_schema_my_second_table_from_loop["my_schema.my_second_table_from_loop"]
    my_schema_my_third_table["my_schema.my_third_table"]
    my_schema_my_third_table_from_loop["my_schema.my_third_table_from_loop"]
    my_schema_my_view["my_schema.my_view"]
    my_schema_recent_users["my_schema.recent_users"]
    my_schema_users_summary["my_schema.users_summary"]
    test_my_schema_my_first_table_id_not_null["my_schema.my_first_table.id.not_null (test)"]:::testNode
    test_my_schema_my_first_table_id_unique["my_schema.my_first_table.id.unique (test)"]:::testNode
    test_my_schema_my_first_table_name_not_null["my_schema.my_first_table.name.not_null (test)"]:::testNode
    test_my_schema_my_first_table_row_count_gt_0["my_schema.my_first_table.row_count_gt_0 (test)"]:::testNode
    test_my_schema_my_first_table_test_my_first_table["my_schema.my_first_table.test_my_first_table (test)"]:::testNode
    test_my_schema_my_second_table_name_not_null["my_schema.my_second_table.name.not_null (test)"]:::testNode
    test_my_schema_my_second_table_row_count_gt_0["my_schema.my_second_table.row_count_gt_0 (test)"]:::testNode
    test_my_schema_my_second_table_unique["my_schema.my_second_table.unique (test)"]:::testNode
    my_schema_my_first_table --> my_schema_users_summary
    my_schema_my_first_table --> my_schema_recent_users
    my_schema_my_first_table --> my_schema_complex_join
    my_schema_my_first_table --> my_schema_my_first_table_from_loop
    my_schema_my_second_table --> my_schema_my_second_table_from_loop
    my_schema_my_third_table --> my_schema_my_third_table_from_loop
    my_schema_my_first_table --> my_schema_incremental_example
    my_schema_my_first_table --> my_schema_my_auto_table_one
    my_schema_my_first_table --> my_schema_my_second_table
    my_schema_my_forth_table --> my_schema_my_view
    my_schema_my_first_table --> my_schema_my_forth_table
    my_schema_my_second_table --> my_schema_my_third_table
    my_schema_my_first_table --> my_schema_my_third_table
    my_schema_my_first_table --> test_my_schema_my_first_table_id_not_null
    my_schema_my_first_table --> test_my_schema_my_first_table_id_unique
    my_schema_my_first_table --> test_my_schema_my_first_table_name_not_null
    my_schema_my_first_table --> test_my_schema_my_first_table_row_count_gt_0
    my_schema_my_first_table --> test_my_schema_my_first_table_test_my_first_table
    my_schema_my_second_table --> test_my_schema_my_second_table_name_not_null
    my_schema_my_second_table --> test_my_schema_my_second_table_row_count_gt_0
    my_schema_my_second_table --> test_my_schema_my_second_table_unique

    %% Execution Order:
    %% 1. my_schema.calculate_percentage
    %% 2. my_schema.my_first_table
    %% 3. my_schema.users_summary
    %% 4. my_schema.recent_users
    %% 5. my_schema.complex_join
    %% 6. my_schema.my_first_table_from_loop
    %% 7. my_schema.incremental_example
    %% 8. my_schema.my_auto_table_one
    %% 9. my_schema.my_second_table
    %% 10. my_schema.my_forth_table
    %% 11. test:my_schema.my_first_table.id.not_null
    %% 12. test:my_schema.my_first_table.id.unique
    %% 13. test:my_schema.my_first_table.name.not_null
    %% 14. test:my_schema.my_first_table.row_count_gt_0
    %% 15. test:my_schema.my_first_table.test_my_first_table
    %% 16. my_schema.my_second_table_from_loop
    %% 17. my_schema.my_third_table
    %% 18. test:my_schema.my_second_table.name.not_null
    %% 19. test:my_schema.my_second_table.row_count_gt_0
    %% 20. test:my_schema.my_second_table.unique
    %% 21. my_schema.my_view
    %% 22. my_schema.my_third_table_from_loop